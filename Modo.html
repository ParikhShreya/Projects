<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modo ‚Ä¢ Fashion E-Commerce UI</title>
  <meta name="description" content="Modo ‚Äî Modern fashion e-commerce UI (HTML, CSS, JS) ‚Äî single file demo.">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --muted:#6b7280;
      --text:#0f1724;
      --accent:#ff6b6b;
      --accent-2:#6b8cff;
      --glass: rgba(255,255,255,0.6);
      --shadow: 0 8px 28px rgba(15,23,42,0.06);
      --radius:14px;
      --max-width:1200px;
      --transition:220ms cubic-bezier(.2,.9,.3,1);
    }
    [data-theme="dark"]{
      --bg:#071026;
      --card:#071426;
      --muted:#9aa4bf;
      --text:#e6eef8;
      --accent:#ff8b8b;
      --accent-2:#7da2ff;
      --glass: rgba(255,255,255,0.03);
      --shadow: 0 12px 32px rgba(0,0,0,0.6);
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family:"Poppins",system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      background:linear-gradient(180deg,var(--bg), #eef2ff 140px);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px 18px;
      transition:background var(--transition), color var(--transition);
      display:flex;
      justify-content:center;
    }
    .container{width:100%;max-width:var(--max-width)}

    /* Header */
    header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;
      background:transparent;
    }
    .brand{
      display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;
    }
    .logo{
      width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:grid;place-items:center;color:white;font-weight:700;font-size:18px;box-shadow:var(--shadow);
    }
    .brand .title{font-weight:700;font-size:18px;line-height:1}
    .brand .tag{font-size:12px;color:var(--muted);margin-top:2px}

    nav{display:flex;gap:14px;align-items:center}
    .nav-link{color:var(--muted);text-decoration:none;font-weight:600;padding:8px 10px;border-radius:10px}
    .nav-link:hover{background:var(--glass);color:var(--text)}

    .controls{display:flex;align-items:center;gap:10px}
    .search{
      display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;background:var(--card);box-shadow:var(--shadow);width:340px;max-width:40%;
    }
    .search input{border:0;background:transparent;outline:0;width:100%;font-size:14px;color:var(--text)}
    .icon-btn{display:inline-grid;place-items:center;width:44px;height:44px;border-radius:10px;background:var(--card);box-shadow:var(--shadow);border:0;cursor:pointer}

    /* Hero */
    .hero{
      display:grid;grid-template-columns:1fr 360px;gap:18px;margin-bottom:18px;align-items:center;
    }
    .hero-card{
      background:linear-gradient(180deg, rgba(255,255,255,0.8), rgba(255,255,255,0.6));padding:22px;border-radius:16px;box-shadow:var(--shadow);
    }
    .hero h1{margin:0;font-size:26px}
    .hero p{margin:6px 0 0;color:var(--muted)}
    .hero .cta{margin-top:14px;padding:10px 14px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));border:0;color:white;font-weight:700;cursor:pointer}

    /* Layout Controls */
    .filters{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:14px}
    .chip{padding:8px 12px;border-radius:999px;background:var(--card);cursor:pointer;border:0;box-shadow:var(--shadow);font-weight:600;color:var(--muted)}
    .chip.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white}

    .sort{margin-left:auto;display:flex;align-items:center;gap:8px}

    /* Grid */
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px;margin-bottom:24px}
    @media(max-width:1100px){ .grid{grid-template-columns:repeat(3,1fr)} .hero{grid-template-columns:1fr} .search{max-width:55%} }
    @media(max-width:760px){ .grid{grid-template-columns:repeat(2,1fr)} header{flex-direction:column;align-items:stretch} .search{width:100%;max-width:100%} .filters{gap:8px} }
    @media(max-width:480px){ .grid{grid-template-columns:1fr} }

    .card{background:var(--card);border-radius:14px;padding:12px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:10px;transition:transform var(--transition)}
    .card:hover{transform:translateY(-8px)}
    .media{height:220px;border-radius:12px;overflow:hidden;background:linear-gradient(180deg, rgba(0,0,0,0.03), transparent)}
    .media img{width:100%;height:100%;object-fit:cover;display:block}
    .meta{display:flex;justify-content:space-between;align-items:center}
    .meta h3{margin:0;font-size:16px}
    .price{font-weight:800}
    .actions{display:flex;gap:8px}

    .btn{flex:1;padding:9px;border-radius:10px;border:0;cursor:pointer;font-weight:700;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white}
    .btn.secondary{background:transparent;color:var(--text);border:1px solid rgba(0,0,0,0.06)}

    /* Cart Sidebar (no images as requested) */
    .cart{
      position:fixed;right:22px;top:80px;width:340px;max-width:92%;height:calc(100vh - 120px);
      background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow);transform:translateX(120%);transition:transform var(--transition);z-index:9999;display:flex;flex-direction:column;gap:10px;
    }
    .cart.open{transform:translateX(0)}
    .cart h3{margin:0}
    .cart-list{overflow:auto;flex:1;padding-right:6px}
    .cart-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(0,0,0,0.01), transparent)}
    .cart-item .left{display:flex;flex-direction:column;gap:6px}
    .cart-item .title{font-weight:700}
    .qty-controls{display:inline-flex;align-items:center;gap:6px}
    .small-btn{padding:6px 8px;border-radius:8px;border:0;background:var(--glass);cursor:pointer}

    .summary{border-top:1px dashed rgba(0,0,0,0.06);padding-top:12px;display:flex;flex-direction:column;gap:8px}

    /* Modal overlay */
    .overlay{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:grid;place-items:center;padding:18px;z-index:9998;opacity:0;pointer-events:none;transition:opacity var(--transition)}
    .overlay.open{opacity:1;pointer-events:auto}
    .modal{background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow);width:880px;max-width:100%;display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:900px){ .modal{grid-template-columns:1fr} }

    /* Footer */
    footer{margin-top:20px;padding:18px;border-radius:12px;background:var(--card);box-shadow:var(--shadow);display:flex;justify-content:space-between;align-items:center;gap:12px}
    footer small{color:var(--muted)}

    /* Chatbot */
    .chat{position:fixed;right:22px;bottom:22px;width:340px;max-width:92%;border-radius:12px;overflow:hidden;box-shadow:var(--shadow);background:var(--card);display:flex;flex-direction:column;z-index:9999}
    .chat .head{padding:10px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;display:flex;justify-content:space-between;align-items:center}
    .chat .messages{padding:12px;max-height:240px;overflow:auto;display:flex;flex-direction:column;gap:8px}
    .bubble{padding:8px 10px;border-radius:12px;background:rgba(255,255,255,0.95);max-width:80%;align-self:flex-start;color:var(--text)}
    .bubble.user{align-self:flex-end;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white}

    /* small helpers */
    .muted{color:var(--muted);font-size:13px}
    .hidden{display:none}
    .tag{padding:6px 8px;border-radius:8px;background:var(--glass);font-size:13px}
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:26px;background:var(--card);padding:10px 14px;border-radius:10px;box-shadow:var(--shadow)}
  </style>
</head>
<body>
  <div class="container" id="app">
    <!-- Header -->
    <header role="banner" aria-label="Main header">
      <a class="brand" href="#" id="logoLink" aria-label="Modo home">
        <div class="logo">M</div>
        <div>
          <div class="title">Modo</div>
          <div class="tag">Modern Fashion UI</div>
        </div>
      </a>

      <nav aria-label="Primary navigation">
        <a class="nav-link" href="#home">Home</a>
        <a class="nav-link" href="#shop">Shop</a>
        <a class="nav-link" href="#lookbook">Lookbook</a>
        <a class="nav-link" href="#about">About</a>
      </nav>

      <div class="controls" role="group" aria-label="Header controls">
        <div class="search" role="search" aria-label="Search products">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <input id="search" placeholder="Search products (e.g., jacket)" aria-label="Search" />
        </div>

        <button class="icon-btn" id="themeBtn" title="Toggle theme" aria-pressed="false" aria-label="Toggle theme">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <button class="icon-btn" id="wishBtn" title="Wishlist" aria-label="Open wishlist">‚ù§</button>
        <button class="icon-btn" id="cartBtn" title="Cart (0)" aria-label="Open cart">üõí</button>
      </div>
    </header>

    <!-- Hero -->
    <section class="hero" id="home" aria-label="Hero section">
      <div class="hero-card" role="region">
        <h1>Elevate your wardrobe with Modo</h1>
        <p class="muted">Minimal, modern styles ‚Äî handpicked collections designed for everyday confidence.</p>
        <div style="display:flex;gap:10px;margin-top:14px;">
          <button class="cta" id="shopNow">Shop Now</button>
          <button class="chip" id="viewLookbook">View Lookbook</button>
        </div>
        <p style="margin-top:12px;color:var(--muted);font-size:13px">Free delivery on orders above ‚Çπ999 ‚Ä¢ Easy returns</p>
      </div>

      <aside style="display:flex;flex-direction:column;gap:12px">
        <div style="padding:12px;border-radius:12px;background:var(--card);box-shadow:var(--shadow)">
          <div class="tag">Limited Offer</div>
          <h4 style="margin:8px 0 6px">Flat 20% Off</h4>
          <p class="muted" style="margin:0">Use code <strong>MODO20</strong> ‚Ä¢ While stocks last</p>
        </div>

        <div style="padding:12px;border-radius:12px;background:var(--card);box-shadow:var(--shadow);text-align:center">
          <div class="muted">Try dark mode</div>
          <div style="margin-top:8px"><button class="chip" id="themeChip">Toggle Theme</button></div>
        </div>
      </aside>
    </section>

    <!-- Filters -->
    <div class="filters" aria-label="Product filters">
      <div id="categoryList" style="display:flex;gap:8px"></div>
      <div class="sort">
        <label class="muted" for="sort">Sort</label>
        <select id="sort" style="padding:8px;border-radius:10px;border:0;background:var(--card);box-shadow:var(--shadow);margin-left:8px">
          <option value="featured">Featured</option>
          <option value="new">New Arrivals</option>
          <option value="low">Price: Low ‚Üí High</option>
          <option value="high">Price: High ‚Üí Low</option>
        </select>
      </div>
    </div>

    <!-- Product Grid -->
    <main id="shop">
      <section class="grid" id="grid" aria-live="polite" aria-label="Products grid">
        <!-- JS injects products -->
      </section>
    </main>

    <!-- Footer -->
    <footer aria-label="Site footer">
      <div style="display:flex;gap:12px;align-items:center">
        <div style="width:56px;height:56px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));display:grid;place-items:center;color:white;font-weight:700">M</div>
        <div>
          <strong>Modo</strong><br><small class="muted">Modern Fashion UI</small>
        </div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <small class="muted">¬© <span id="yr">2025</span> Modo. All Rights Reserved.</small>
        <div style="display:flex;gap:8px">
          <a class="nav-link" href="#about">Terms</a>
          <a class="nav-link" href="#contact">Contact</a>
        </div>
      </div>
    </footer>
  </div>

  <!-- Cart (Sidebar) - NO IMAGES as requested -->
  <aside class="cart" id="cart" aria-hidden="true" aria-label="Shopping cart">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3 style="margin:0">Your Cart</h3>
      <div class="muted" id="cartCountLabel">0 items</div>
    </div>
    <div class="cart-list" id="cartList">
      <div class="muted center">Your cart is empty ‚Äî add items to see them here.</div>
    </div>

    <div class="summary">
      <div style="display:flex;justify-content:space-between"><span class="muted">Subtotal</span><strong id="sub">‚Çπ0</strong></div>
      <div style="display:flex;justify-content:space-between"><span class="muted">Shipping</span><span class="muted">‚Çπ49</span></div>
      <div style="display:flex;justify-content:space-between"><strong>Total</strong><strong id="total">‚Çπ0</strong></div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" id="checkout">Checkout</button>
        <button class="btn secondary" id="clearCart">Clear</button>
      </div>
    </div>
  </aside>

  <!-- Quick View Modal -->
  <div class="overlay" id="modalOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div style="display:flex;flex-direction:column;gap:8px">
        <div class="media" id="modalImage"><!-- image injected --></div>
        <div class="muted" id="modalCategory">Category</div>
        <div style="display:flex;gap:8px">
          <button class="chip" id="sizeS">S</button>
          <button class="chip" id="sizeM">M</button>
          <button class="chip" id="sizeL">L</button>
        </div>
      </div>

      <div style="display:flex;flex-direction:column;gap:12px">
        <div style="display:flex;justify-content:space-between;align-items:start">
          <h3 id="modalTitle" style="margin:0">Product</h3>
          <button class="small-btn" id="closeModal">Close</button>
        </div>
        <div id="modalPrice" style="font-size:20px;font-weight:800">‚Çπ0</div>
        <p id="modalDesc" class="muted" style="margin:0">Description</p>
        <div style="display:flex;gap:8px">
          <button class="btn" id="modalAdd">Add to Cart</button>
          <button class="btn secondary" id="modalWish">Wishlist</button>
        </div>
        <div class="muted" id="recs">You may also like</div>
      </div>
    </div>
  </div>

  <!-- Wishlist modal -->
  <div class="overlay" id="wishOverlay" aria-hidden="true">
    <div style="background:var(--card);padding:16px;border-radius:12px;box-shadow:var(--shadow);width:640px;max-width:96%">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 style="margin:0">Wishlist</h3>
        <button class="small-btn" id="closeWish">Close</button>
      </div>
      <div id="wishList" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- Chat -->
  <div style="position:fixed;left:22px;bottom:22px;z-index:9999">
    <button id="chatToggle" class="icon-btn" title="Chat assistant" aria-label="Open chat">üí¨</button>
  </div>

  <div class="chat hidden" id="chat" aria-hidden="true" style="right:22px;bottom:22px;position:fixed;z-index:9999">
    <div class="head">
      <div style="display:flex;gap:10px;align-items:center">
        <div style="width:36px;height:36px;border-radius:8px;background:white;color:var(--text);display:grid;place-items:center">AI</div>
        <div><strong>Modo Assistant</strong><div class="muted" style="font-size:12px">Ask: "show jackets", "what's in my cart"</div></div>
      </div>
      <button class="small-btn" id="closeChat">X</button>
    </div>
    <div class="messages" id="chatMessages">
      <div class="bubble">Hi! I can help find items. Try: "men jackets", "show sneakers", or "what's in my cart?"</div>
    </div>
    <div style="display:flex;padding:10px;gap:8px">
      <input id="chatInput" placeholder="Type message..." style="flex:1;padding:8px;border-radius:8px;border:0;background:var(--bg);outline:0">
      <button class="btn" id="sendChat">Send</button>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden"></div>

<script>
/* ========= Data (12 sample products) ========= */
const PRODUCTS = [
  {id:'m1', title:'Denim Jacket', price:2499, category:'Men', img:'https://madish.in/wp-content/uploads/2025/01/fringed-light-blue-denim-jacket-jackets-madish-840094.jpg', badge:'New', rating:4.5, desc:'Classic denim jacket with comfortable fit.'},
  {id:'m2', title:'Oversized Hoodie', price:999, category:'Men', img:'https://images.unsplash.com/photo-1512436991641-6745cdb1723f?q=80&w=1200&auto=format&fit=crop', badge:'Popular', rating:4.6, desc:'Warm hoodie for casual wear.'},
  {id:'w1', title:'Silk Midi Dress', price:2899, category:'Women', img:'https://manitosilk.com/wp-content/uploads/04df432e91cd9788a3c09d99baee0c9.jpg', badge:'New', rating:4.7, desc:'Elegant silk dress for special occasions.'},
  {id:'w2', title:'Tailored Blazer', price:4999, category:'Women', img:'https://images.unsplash.com/photo-1552374196-c4e7ffc6e126?q=80&w=1200&auto=format&fit=crop', badge:'Top', rating:4.8, desc:'Sharp blazer to elevate your look.'},
  {id:'u1', title:'Canvas Sneakers', price:1299, category:'Unisex', img:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=1200&auto=format&fit=crop', badge:'Sale', rating:4.4, desc:'Comfortable everyday sneakers.'},
  {id:'a1', title:'Crossbody Bag', price:1599, category:'Accessories', img:'https://ap.targus.com/cdn/shop/products/GFX02408_1_1024x1024.jpg?v=1617182243&auto=format&fit=crop', badge:'', rating:4.1, desc:'Sleek crossbody bag with pockets.'},
  {id:'m3', title:'Leather Boots', price:3999, category:'Men', img:'https://craftandglory.in/cdn/shop/products/DSC00579_1.jpg?v=1746698379&width=1946', badge:'Limited', rating:4.6, desc:'Sturdy leather boots for all seasons.'},
  {id:'w3', title:'Summer Blouse', price:799, category:'Women', img:'https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?q=80&w=1200&auto=format&fit=crop', badge:'', rating:4.2, desc:'Lightweight blouse for daily wear.'},
  {id:'a2', title:'Silk Scarf', price:599, category:'Accessories', img:'https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?q=80&w=1200&auto=format&fit=crop', badge:'', rating:4.2, desc:'Elegant scarf to style any outfit.'},
  {id:'u2', title:'Track Pants', price:899, category:'Unisex', img:'https://imagescdn.reebok.in/img/app/product/3/39680170-13833042.jpg?auto=format&w=390', badge:'New', rating:4.3, desc:'Relaxed track pants with breathable fabric.'},
  {id:'m4', title:'Graphic Tee', price:499, category:'Men', img:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=1200&auto=format&fit=crop', badge:'Popular', rating:4.5, desc:'Casual tee with modern print.'},
  {id:'w4', title:'Pleated Skirt', price:1499, category:'Women', img:'https://images-cdn.ubuy.co.in/6611f5d1904d797eea3a5db4-elastic-waist-girls-women-high-waisted.jpg', badge:'', rating:4.1, desc:'Flowy pleated skirt.'}
];
const CATEGORIES = ['All','Men','Women','Unisex','Accessories'];

/* ========= State (persisted) ========= */
const state = {
  products: PRODUCTS.slice(),
  cart: JSON.parse(localStorage.getItem('modo_cart') || '{}'),
  wishlist: JSON.parse(localStorage.getItem('modo_wish') || '[]'),
  theme: localStorage.getItem('modo_theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'),
  recent: JSON.parse(localStorage.getItem('modo_recent') || '[]')
};

/* ========= Helpers ========= */
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
const money = v => `‚Çπ${v.toLocaleString('en-IN')}`;

/* ========= Elements ========= */
const grid = $('#grid');
const search = $('#search');
const sort = $('#sort');
const cartBtn = $('#cartBtn');
const cart = $('#cart');
const cartList = $('#cartList');
const cartCountLabel = $('#cartCountLabel');
const subEl = $('#sub');
const totalEl = $('#total');
const clearCartBtn = $('#clearCart');
const checkoutBtn = $('#checkout');

const categoryList = $('#categoryList');
const toast = $('#toast');

const modalOverlay = $('#modalOverlay');
const modalTitle = $('#modalTitle');
const modalImage = $('#modalImage');
const modalPrice = $('#modalPrice');
const modalDesc = $('#modalDesc');
const modalAdd = $('#modalAdd');
const modalWish = $('#modalWish');
const closeModalBtn = $('#closeModal');
const recsEl = $('#recs');

const wishOverlay = $('#wishOverlay');
const wishListEl = $('#wishList');
const wishBtn = $('#wishBtn');
const closeWish = $('#closeWish');

const themeBtn = $('#themeBtn');
const themeChip = $('#themeChip');

const chatToggle = $('#chatToggle');
const chat = $('#chat');
const closeChat = $('#closeChat');
const chatMessages = $('#chatMessages');
const chatInput = $('#chatInput');
const sendChat = $('#sendChat');

const yr = $('#yr'); yr.textContent = new Date().getFullYear();

/* ========= Rendering ========= */
function renderCategories(){
  categoryList.innerHTML = '';
  CATEGORIES.forEach((c,i)=>{
    const b = document.createElement('button');
    b.className = 'chip' + (i===0 ? ' active' : '');
    b.textContent = c;
    b.dataset.cat = c;
    b.addEventListener('click', ()=>{
      $$('.chip').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      renderProducts();
    });
    categoryList.appendChild(b);
  });
}

function getActiveCategory(){
  const el = document.querySelector('.chip.active');
  return el ? el.dataset.cat : 'All';
}

function filterSort(){
  const q = search.value.trim().toLowerCase();
  const cat = getActiveCategory();
  let list = state.products.filter(p=>{
    const matchQ = !q || p.title.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q);
    const matchCat = cat === 'All' || p.category === cat;
    return matchQ && matchCat;
  });
  const s = sort.value;
  if(s === 'low') list.sort((a,b)=>a.price - b.price);
  else if(s === 'high') list.sort((a,b)=>b.price - a.price);
  else if(s === 'new') list.sort((a,b)=> b.id.localeCompare(a.id));
  return list;
}

function renderProducts(){
  const list = filterSort();
  grid.innerHTML = '';
  if(list.length === 0){
    grid.innerHTML = `<div class="muted center" style="grid-column:1/-1">No products found</div>`;
    return;
  }
  list.forEach(p=>{
    const el = document.createElement('article');
    el.className = 'card';
    el.innerHTML = `
      <div class="media" aria-hidden="true"><img src="${p.img}" alt="${p.title}"></div>
      <div class="meta">
        <div>
          <h3>${p.title}</h3>
          <div class="muted">${p.category} ‚Ä¢ ${p.rating} ‚òÖ</div>
        </div>
        <div class="price">${money(p.price)}</div>
      </div>
      <div style="display:flex;gap:8px" class="actions">
        <button class="btn add" data-id="${p.id}">Add to cart</button>
        <button class="btn secondary view" data-id="${p.id}">Quick view</button>
      </div>
    `;
    el.querySelector('.add').addEventListener('click', ()=> addToCart(p.id));
    el.querySelector('.view').addEventListener('click', ()=> openModal(p.id));
    el.querySelector('.media').addEventListener('click', ()=> openModal(p.id));
    grid.appendChild(el);
  });
}

/* ========= Cart Logic (NO IMAGES in cart view) ========= */
function saveState(){ localStorage.setItem('modo_cart', JSON.stringify(state.cart)); localStorage.setItem('modo_wish', JSON.stringify(state.wishlist)); localStorage.setItem('modo_theme', state.theme); localStorage.setItem('modo_recent', JSON.stringify(state.recent)); }
function addToCart(id, qty=1){
  if(!state.cart[id]) state.cart[id] = 0;
  state.cart[id] += qty;
  saveState();
  showToast('Added to cart');
  openCart();
  renderCart();
}
function removeFromCart(id){
  delete state.cart[id];
  saveState();
  renderCart();
}
function changeQty(id, delta){
  if(!state.cart[id]) return;
  state.cart[id] += delta;
  if(state.cart[id] <= 0) removeFromCart(id);
  else { saveState(); renderCart(); }
}
function calcCart(){
  let subtotal = 0, count = 0;
  const details = Object.entries(state.cart).map(([id,qty])=>{
    const p = state.products.find(x=>x.id===id);
    if(!p) return null;
    subtotal += p.price * qty;
    count += qty;
    return { id:p.id, title:p.title, price:p.price, qty };
  }).filter(Boolean);
  return { details, subtotal, count };
}
function renderCart(){
  const { details, subtotal, count } = calcCart();
  cartCountLabel.textContent = `${count} item${count!==1 ? 's' : ''}`;
  $('#cartBtn').title = `Cart (${count})`;
  $('#cartBtn').setAttribute('aria-label', `Open cart (${count})`);
  subEl.textContent = money(subtotal);
  totalEl.textContent = money(subtotal + (count ? 49 : 0));
  cartList.innerHTML = '';
  if(details.length === 0){
    cartList.innerHTML = `<div class="muted center">Your cart is empty ‚Äî add items to see them here.</div>`;
    return;
  }
  details.forEach(it=>{
    const row = document.createElement('div');
    row.className = 'cart-item';
    row.innerHTML = `
      <div class="left">
        <div class="title">${it.title}</div>
        <div class="muted" style="font-size:13px">${money(it.price)} each</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
        <div class="qty-controls">
          <button class="small-btn dec" data-id="${it.id}">‚àí</button>
          <div style="min-width:36px;display:grid;place-items:center;padding:6px 8px;border-radius:8px;background:var(--glass)">${it.qty}</div>
          <button class="small-btn inc" data-id="${it.id}">+</button>
        </div>
        <div style="font-weight:700">${money(it.price * it.qty)}</div>
        <button class="small-btn remove" data-id="${it.id}">Remove</button>
      </div>
    `;
    row.querySelector('.dec').addEventListener('click', ()=> changeQty(it.id, -1));
    row.querySelector('.inc').addEventListener('click', ()=> changeQty(it.id, 1));
    row.querySelector('.remove').addEventListener('click', ()=> removeFromCart(it.id));
    cartList.appendChild(row);
  });
}

/* ========= Wishlist ========= */
function renderWishlist(){
  wishListEl.innerHTML = '';
  if(state.wishlist.length === 0){
    wishListEl.innerHTML = `<div class="muted">Your wishlist is empty.</div>`;
    return;
  }
  state.wishlist.forEach(id=>{
    const p = state.products.find(x=>x.id===id);
    if(!p) return;
    const row = document.createElement('div');
    row.style.display = 'flex'; row.style.justifyContent = 'space-between'; row.style.alignItems = 'center'; row.style.padding = '8px 0';
    row.innerHTML = `<div><strong>${p.title}</strong><div class="muted">${money(p.price)}</div></div>
      <div style="display:flex;flex-direction:column;gap:6px">
        <button class="small-btn add" data-id="${p.id}">Add to cart</button>
        <button class="small-btn rem" data-id="${p.id}">Remove</button>
      </div>`;
    row.querySelector('.add').addEventListener('click', ()=> { addToCart(p.id); removeFromWish(p.id); });
    row.querySelector('.rem').addEventListener('click', ()=> removeFromWish(p.id));
    wishListEl.appendChild(row);
  });
}
function addToWish(id){
  if(!state.wishlist.includes(id)) state.wishlist.push(id);
  saveState();
  showToast('Added to wishlist');
  renderWishlist();
}
function removeFromWish(id){
  state.wishlist = state.wishlist.filter(x=>x!==id);
  saveState();
  showToast('Removed from wishlist');
  renderWishlist();
}

/* ========= Modal (Quick View) ========= */
function openModal(id){
  const p = state.products.find(x=>x.id===id);
  if(!p) return;
  modalOverlay.classList.add('open');
  modalOverlay.setAttribute('aria-hidden','false');
  modalTitle.textContent = p.title;
  modalImage.innerHTML = `<img src="${p.img}" alt="${p.title}" style="width:100%;height:100%;object-fit:cover">`;
  modalPrice.textContent = money(p.price);
  modalPrice.id = 'modalPrice';
  modalDesc.textContent = p.desc;
  modalAdd.onclick = ()=> { addToCart(p.id); closeModal(); };
  modalWish.onclick = ()=> addToWish(p.id);
  // recommendations
  const recs = state.products.filter(x=>x.category===p.category && x.id!==p.id).slice(0,4);
  recsEl.innerHTML = 'You may also like: ' + recs.map(r=>`<span class="tag" style="margin-right:6px">${r.title}</span>`).join('');
  // record recent
  state.recent = state.recent.filter(x=>x!==p.id);
  state.recent.unshift(p.id);
  state.recent = state.recent.slice(0,8);
  saveState();
}
function closeModal(){ modalOverlay.classList.remove('open'); modalOverlay.setAttribute('aria-hidden','true'); }

/* ========= Chatbot (simple) ========= */
function addChat(msg, user=false){
  const b = document.createElement('div'); b.className = 'bubble' + (user ? ' user' : ''); b.textContent = msg;
  chatMessages.appendChild(b); chatMessages.scrollTop = chatMessages.scrollHeight;
}
function botReply(text){
  const t = text.toLowerCase();
  if(t.includes('jacket')) return "Try: 'Denim Jacket' or 'Leather Boots' ‚Äî use search or filter 'Men'.";
  if(t.includes('sneak') || t.includes('shoe')) return "Check 'Canvas Sneakers' under 'Unisex'.";
  if(t.includes('cart')) {
    const {count} = calcCart(); return `You have ${count} item${count!==1 ? 's' : ''} in your cart.`;
  }
  if(t.includes('wishlist')) return `You have ${state.wishlist.length} wishlist item${state.wishlist.length!==1 ? 's' : ''}.`;
  return "I'm a demo assistant ‚Äî try 'show jackets', 'what's in my cart', or 'add denim jacket'.";
}

/* ========= UI helpers ========= */
function showToast(msg, time=1600){
  toast.textContent = msg; toast.classList.remove('hidden');
  setTimeout(()=> toast.classList.add('hidden'), time);
}
function openCart(){ cart.classList.add('open'); cart.setAttribute('aria-hidden','false'); renderCart(); }
function closeCart(){ cart.classList.remove('open'); cart.setAttribute('aria-hidden','true'); }

/* ========= Events ========= */
search.addEventListener('input', debounce(()=> renderProducts(), 180));
sort.addEventListener('change', ()=> renderProducts());
$('#shopNow').addEventListener('click', ()=> window.scrollTo({top: document.getElementById('shop').offsetTop - 60, behavior:'smooth'}));
$('#viewLookbook').addEventListener('click', ()=> alert('Lookbook demo ‚Äî replace with actual section.'));

grid.addEventListener('click', (e)=>{
  const add = e.target.closest('.add');
  if(add) addToCart(add.dataset.id);
  const view = e.target.closest('.view');
  if(view) openModal(view.dataset.id);
});

cartBtn.addEventListener('click', ()=> { if(cart.classList.contains('open')) closeCart(); else openCart(); });
clearCartBtn.addEventListener('click', ()=> { state.cart = {}; saveState(); renderCart(); showToast('Cart cleared'); });
checkoutBtn.addEventListener('click', ()=> alert('Checkout demo ‚Äî integrate payment flow.'));

modalOverlay.addEventListener('click', (e)=> { if(e.target === modalOverlay) closeModal(); });
closeModalBtn.addEventListener('click', closeModal);

wishBtn.addEventListener('click', ()=> { wishOverlay.classList.add('open'); wishOverlay.setAttribute('aria-hidden','false'); renderWishlist(); });
closeWish.addEventListener('click', ()=> { wishOverlay.classList.remove('open'); wishOverlay.setAttribute('aria-hidden','true'); });

themeBtn.addEventListener('click', toggleTheme);
themeChip.addEventListener('click', toggleTheme);

chatToggle.addEventListener('click', ()=> { chat.classList.toggle('hidden'); chat.setAttribute('aria-hidden', chat.classList.contains('hidden') ? 'true' : 'false'); });
closeChat.addEventListener('click', ()=> { chat.classList.add('hidden'); chat.setAttribute('aria-hidden','true'); });

sendChat.addEventListener('click', ()=> {
  const txt = chatInput.value.trim(); if(!txt) return;
  addChat(txt, true); chatInput.value = '';
  setTimeout(()=> addChat(botReply(txt), false), 500);
});
chatInput.addEventListener('keypress', (e)=> { if(e.key === 'Enter') sendChat.click(); });

/* ========= Theme ========= */
function applyTheme(){ document.documentElement.setAttribute('data-theme', state.theme); themeBtn.setAttribute('aria-pressed', state.theme==='dark'); }
function toggleTheme(){ state.theme = state.theme === 'dark' ? 'light' : 'dark'; applyTheme(); saveState(); }

/* ========= Utils ========= */
function debounce(fn, ms=200){ let t; return (...a)=>{ clearTimeout(t); t = setTimeout(()=> fn.apply(this,a), ms); }; }

/* ========= Init / Mount ========= */
function mount(){
  renderCategories();
  renderProducts();
  renderCart();
  applyTheme();
  // show recent (simple)
  if(state.recent.length){
    const recent = state.recent.map(id => state.products.find(p=>p.id===id)).filter(Boolean);
    if(recent.length){
      const sec = document.createElement('section');
      sec.style.marginTop = '18px';
      sec.innerHTML = `<h3>Recently viewed</h3><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-top:8px">
        ${recent.map(r=>`<div style="background:var(--card);padding:8px;border-radius:10px;box-shadow:var(--shadow);display:flex;gap:8px;align-items:center">
          <div style="flex:1"><strong>${r.title}</strong><div class="muted">${money(r.price)}</div></div></div>`).join('')}
        </div>`;
      document.querySelector('.container').appendChild(sec);
    }
  }
}
mount();

/* ========= Persist before unload ========= */
window.addEventListener('beforeunload', ()=> saveState());

</script>
</body>
</html>
